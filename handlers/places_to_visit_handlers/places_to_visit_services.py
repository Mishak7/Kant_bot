import asyncio
import sqlite3
from typing import List, Dict, Any
from langchain_gigachat import GigaChat
from langchain.schema import HumanMessage
import random

from config.settings import settings

class PlacesDatabase:
    def __init__(self, db_path: str = "places.db"):
        self.db_path = db_path
        self.init_database()

    def init_database(self):
        """DB initialization and tables creation"""
        with sqlite3.connect(self.db_path) as conn:
            cursor = conn.cursor()

            cursor.execute('''
                CREATE TABLE IF NOT EXISTS places (
                    id INTEGER PRIMARY KEY,
                    name TEXT NOT NULL,
                    type TEXT NOT NULL,
                    description TEXT,
                    link TEXT,
                    is_seasonal BOOLEAN DEFAULT 0,
                    best_season TEXT,
                    indoor BOOLEAN DEFAULT 0
                )
            ''')

            cursor.execute('''
                CREATE TABLE IF NOT EXISTS events (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    name TEXT NOT NULL,
                    description TEXT,
                    start_date TEXT,
                    end_date TEXT,
                    link TEXT,
                    is_active BOOLEAN DEFAULT 1
                )
            ''')

            conn.commit()

    def populate_database(self):
        """DB fill"""
        places_data = [
            (1, "–§—å—é–∂–Ω –≠–∫—Å–ø—Ä–µ—Å—Å", "–∫–∞—Ñ–µ",
             "–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è - –∑—É–º–º–µ—Ä—ã. –í –∫–∞—Ñ–µ ¬´–§—å—é–∂–Ω —ç–∫—Å–ø—Ä–µ—Å—Å¬ª –ø–æ–¥–∞—é—Ç –≤–∫—É—Å–Ω—É—é –ø–∞–Ω–∞–∑–∏–∞—Ç—Å–∫—É—é –µ–¥—É —Å –±–æ–ª—å—à–∏–º–∏ –ø–æ—Ä—Ü–∏—è–º–∏. –í –º–µ–Ω—é –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —à–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä –±–ª—é–¥, –≤–∫–ª—é—á–∞—è –ª–∞–ø—à—É, —Ä–∞–º–µ–Ω, –≤–æ–∫ –∏ –¥—Ä—É–≥–∏–µ –∞–∑–∏–∞—Ç—Å–∫–∏–µ –±–ª—é–¥–∞. –ï—Å—Ç—å –±–ª—é–¥–∞, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –≤–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Ü–µ–≤ –∏ –≤–µ–≥–∞–Ω–æ–≤. –¶–µ–Ω—ã –¥–æ—Å—Ç—É–ø–Ω—ã–µ, –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ. –ü—Ä–µ–¥–ª–∞–≥–∞—é—Ç—Å—è –Ω–∞–ø–∏—Ç–∫–∏, –∫ –ø—Ä–∏–º–µ—Ä—É —á–∞–π –∏ –∫–æ—Ñ–µ. –ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞—Ç—å –±–ª—é–¥–∞ –Ω–∞ –≤—ã–Ω–æ—Å –∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É.",
             "https://fusion-ex.su", 0, "all", 1),
            (2, "–ù–∏–∂–Ω–∏–π –ø—Ä—É–¥/–ù–∏–∂–Ω–µ–µ –æ–∑–µ—Ä–æ/–ù–∏–∂–∫–∞", "–ø—Ä—É–¥/–æ–∑–µ—Ä–æ",
             "–ú–µ—Å—Ç–æ –≤—Å—Ç—Ä–µ—á —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Ñ–∏–∑–º–∞—Ç–∞, –∞ –∫—Ä–æ–º–µ —ç—Ç–æ–≥–æ –æ—Ç–ª–∏—á–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –ø—Ä–æ–≥—É–ª–∫–∏, –ø—Ä–æ–±–µ–∂–∫–∏, —Ç–∏—Ö–∏–π –æ—Ç–¥—ã—Ö",
             "https://go.2gis.com/oyFpe", 1, "spring,summer,autumn", 0),
            (3, "–ì–∞—Ä—Ä–∏ –î–∂–æ–Ω—Å–æ–Ω", "–±–∞—Ä",
             "–≠—Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ –º–æ–∂–Ω–æ —Ä–∞—Å—Å–ª–∞–±–∏—Ç—å—Å—è –ø–æ—Å–ª–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è –∏–ª–∏ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤–µ—á–µ—Ä —Å –¥—Ä—É–∑—å—è–º–∏. –≠—Ç–æ –æ—Ç–ª–∏—á–Ω–æ–µ –º–µ—Å—Ç–æ, –≥–¥–µ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞–ø–∏—Ç–∫–∏ –Ω–∞ –ª—é–±–æ–π –≤–∫—É—Å. –ü–æ—Å–µ—Ç–∏—Ç–µ–ª–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –≤—ã–¥–µ–ª—è—é—Ç –±–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä –∫–æ–∫—Ç–µ–π–ª–µ–π –∏ —à–æ—Ç–æ–≤. –ë–∞—Ä–º–µ–Ω—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å —Å –≤—ã–±–æ—Ä–æ–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä. –ò–Ω—Ç–µ—Ä—å–µ—Ä –∑–∞–≤–µ–¥–µ–Ω–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω –≤ —Å—Ç–∏–ª—å–Ω–æ–º –¥–∏–∑–∞–π–Ω–µ. –í –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ –±–∞—Ä –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ç–∞–Ω—Ü–ø–æ–ª —Å –∂–∏–≤–æ–π –º—É–∑—ã–∫–æ–π, —á—Ç–æ –æ—á–µ–Ω—å –Ω—Ä–∞–≤–∏—Ç—Å—è –≥–æ—Å—Ç—è–º. –û—Ö—Ä–∞–Ω–Ω–∏–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π. –≠—Ç–æ –æ–¥–Ω–æ –∏–∑ –ª—é–±–∏–º—ã—Ö –º–µ—Å—Ç –¥–ª—è –æ—Ç–¥—ã—Ö–∞ –∫–∞–∫ –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞, —Ç–∞–∫ –∏ –∫–æ–º–ø–∞–Ω–∏–∏ –¥—Ä—É–∑–µ–π.",
             "https://go.2gis.com/T3Mzi", 0, "all", 1),
            (4, "–ï–ª—å—Ü–∏–Ω", "–±–∞—Ä",
             "–ë–∞—Ä —Å –∞—Ç–º–æ—Å—Ñ–µ—Ä–æ–π –°–°–°–†, –Ω–æ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏—Ä–æ–Ω–∏—á–Ω–æ–π –ø–æ–¥–∞—á–µ–π. –≠—Ç–æ –±–∞—Ä –∫—Ä–∞—Ñ—Ç–æ–≤–æ–≥–æ –ø–∏–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ —Å—Ç–∏–ª—å–Ω—ã–º –∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–º –≤ —Å—Ç–∏–ª–µ –∞–Ω–¥–µ—Ä–≥—Ä–∞—É–Ω–¥–∞. –ì–æ—Å—Ç–∏ –æ—Ç–º–µ—á–∞—é—Ç –±–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä –∫—Ä–∞—Ñ—Ç–æ–≤–æ–≥–æ –ø–∏–≤–∞ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –∑–∞–∫—É—Å–∫–∏. –ó–¥–µ—Å—å —á–∞—Å—Ç–æ –ø—Ä–æ—Ö–æ–¥—è—Ç –∫–æ–Ω—Ü–µ—Ä—Ç—ã, –≤–µ—á–µ—Ä–∏–Ω–∫–∏ —Å –∂–∏–≤–æ–π –º—É–∑—ã–∫–æ–π –∏ —á–µ–º–ø–∏–æ–Ω–∞—Ç—ã –ø–æ –∫–∏–∫–µ—Ä—É. –ü–æ—Å–µ—Ç–∏—Ç–µ–ª–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –≤—ã–¥–µ–ª—è—é—Ç –±–µ–∑–∞–ª–∫–æ–≥–æ–ª—å–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏ –∏ –≤–∫—É—Å–Ω—É—é –µ–¥—É, –Ω–∞–ø—Ä–∏–º–µ—Ä –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å–Ω—ã–µ –¥–æ–ª—å–∫–∏ —Å —Å—ã—Ä–æ–º –∏ –ª—É–∫–æ–º –∏–ª–∏ –∫–∞—Ä—Ä–∏–≤—É—Ä—Å—Ç. –¢–∞–∫–∂–µ –∑–¥–µ—Å—å –µ—Å—Ç—å –≥–∞–ª–µ—Ä–µ—è –¥–ª—è –º–µ—Å—Ç–Ω—ã—Ö —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤ –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–æ–≤.",
             "https://go.2gis.com/k2i7Y", 0, "all", 1),
            (5, "–í–∞–≥–æ–Ω–∫–∞", "–∫–ª—É–±/–∫–æ–Ω—Ü–µ—Ä—Ç–Ω–∞—è –ø–ª–æ—â–∞–¥–∫–∞",
             "–ö–ª—É–± ¬´–í–∞–≥–æ–Ω–∫–∞¬ª —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ –∑–¥–∞–Ω–∏–∏ –±—ã–≤—à–µ–π –Ω–µ–º–µ—Ü–∫–æ–π –ö–∏—Ä—Ö–∏ –•—Ä–∏—Å—Ç–∞ –≤ –†–∞—Ç—Å—Ö–æ—Ñ–µ (–Ω–µ–º. Christuskirche in Ratshof). –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≤–µ–¥–µ–Ω–∏—è –Ω–∞—á–∞–ª–∞—Å—å –≤ 1977 –≥–æ–¥–∞, ¬´–í–∞–≥–æ–Ω–∫–∞¬ª ‚Äì —Å—Ç–∞—Ä–µ–π—à–∏–π –∫–ª—É–± –†–æ—Å—Å–∏–∏ –∏ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ–≥–∏–æ–Ω–∞.",
             "http://vagonka.net", 0, "all", 1),
            (6, "–†–µ–∑–∏–¥–µ–Ω—Ü–∏—è –∫–æ—Ä–æ–ª–µ–π", "—Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
             "–ì–æ—Å—Ç–µ–π –∂–¥—É—Ç —Å–µ–º—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤: –ø–∏–≤–æ–≤–∞—Ä–Ω—è ¬´–ë—Ä–µ—Ü–µ–ª—å¬ª, —Ç—Ä–∞—Ç—Ç–æ—Ä–∏—è ¬´–î–∂—É–∑–µ–ø–ø–µ¬ª, Cafe ¬´La Russe¬ª, –≤–æ—Å—Ç–æ—á–Ω—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω ¬´–®–∞—Ñ—Ä–∞–Ω¬ª, ¬´–•–∏–Ω–∫–∞–ª–∏¬ª, –≥—Ä–∏–ª—å-—Ä–µ—Å—Ç–æ—Ä–∞–Ω ¬´–í–µ—Ä–∞–Ω–¥–∞¬ª, ¬´–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π –î–≤–æ—Ä–∏–∫¬ª. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤–µ—á–µ—Ä —Å –≤–µ—Å–µ–ª–æ–π –∫–æ–º–ø–∞–Ω–∏–µ–π –º–æ–∂–Ω–æ –≤ –ö–∞—Ä–∞–æ–∫–µ –∏ —Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω–æ–º –±–∞—Ä–µ ¬´Berry¬ª.",
             "https://go.2gis.com/jqYy5", 0, "all", 1),
            (7, "–ü–ª–∞–Ω–µ—Ç–∞", "–Ω–æ—á–Ω–æ–π –∫–ª—É–±",
             "–≠—Ç–æ –º–µ—Å—Ç–æ, –∫–æ—Ç–æ—Ä–æ–µ –º–Ω–æ–≥–∏–µ —Å—á–∏—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω—ã–º –¥–ª—è –æ—Ç–¥—ã—Ö–∞. –ì–æ—Å—Ç–∏ –æ—Ç–º–µ—á–∞—é—Ç –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º –ø–µ—Ä—Å–æ–Ω–∞–ª–∞. –û—Å–æ–±–µ–Ω–Ω–æ –≤—ã–¥–µ–ª—è—é—Ç –±—ã—Å—Ç—Ä–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –Ω–∞ –±–∞—Ä–µ –∏ –≤ –∑–∞–ª–µ, –∞ —Ç–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞—Ç—å –∞–≤—Ç–æ—Ä—Å–∫–∏–µ –∫–æ–∫—Ç–µ–π–ª–∏. –ö–ª–∏–µ–Ω—Ç—ã —á–∞—Å—Ç–æ —É–ø–æ–º–∏–Ω–∞—é—Ç –¥—Ä—É–∂–µ–ª—é–±–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ –ø—Ä–∏—è—Ç–Ω—É—é –º—É–∑—ã–∫—É –≤ Chill-out –∑–æ–Ω–µ —Å —É–¥–æ–±–Ω—ã–º–∏ –¥–∏–≤–∞–Ω–∞–º–∏ –¥–ª—è –∏–≥—Ä—ã –≤ PlayStation. –ú–Ω–æ–≥–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–∑—ã–≤–∞—é—Ç—Å—è –æ –∫–∞—á–µ—Å—Ç–≤–µ –µ–¥—ã –∏ –Ω–∞–ø–∏—Ç–∫–æ–≤, –∞ —Ç–∞–∫–∂–µ –æ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ–º –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –∫ –≥–æ—Å—Ç—è–º.",
             "https://go.2gis.com/crItT", 0, "all", 1),
            (8, "–ó–∞—Ä—è", "–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä",
             "–ê—Ä—Ç-–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä - –º–æ–∂–Ω–æ —Å–Ω—è—Ç—å –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä/–∑–∞–ª –ø–æ–¥ —Å–µ–±—è –Ω–∞ —Å–∞–º–æ–º –∫—Ä–∞—Å–∏–≤–æ–º –ø—Ä–æ—Å–ø–µ–∫—Ç–µ –≥–æ—Ä–æ–¥–∞",
             "https://go.2gis.com/4155g", 0, "all", 1),
            (9, "–õ–æ–Ω–¥–æ–Ω", "—Ä–µ—Å—Ç–æ—Ä–∞–Ω/–ø–∞–±",
             "–≠—Ç–æ –∑–∞–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ –±–æ–ª—å—à–∏–º –≤—ã–±–æ—Ä–æ–º –ø–∏–≤–∞ –∏ –≤–∫—É—Å–Ω–æ–π –∫—É—Ö–Ω–∏. –ì–æ—Å—Ç–∏ –æ—Ç–º–µ—á–∞—é—Ç, —á—Ç–æ –∑–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç–ª–∏—á–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤—Ä–µ–º—è –∫–∞–∫ –≤ –±—É–¥–Ω–∏–µ –¥–Ω–∏, —Ç–∞–∫ –∏ –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö. –ò–Ω—Ç–µ—Ä—å–µ—Ä –æ—Ñ–æ—Ä–º–ª–µ–Ω –≤ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —Å—Ç–∏–ª–µ. –í —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ —á–∞—Å—Ç–æ –ø—Ä–æ—Ö–æ–¥—è—Ç –∫–æ–Ω—Ü–µ—Ä—Ç—ã –∏ –¥–∏—Å–∫–æ—Ç–µ–∫–∏.",
             "https://go.2gis.com/S4QMU", 0, "all", 1),
            (10, "Fiji", "–Ω–æ—á–Ω–æ–π –∫–ª—É–±/–±–∞—Ä/–∫–∞—Ä–∞–æ–∫–µ",
             "–õ—é–¥–∏ –æ—Ç–º–µ—á–∞—é—Ç –∑–¥–µ—Å—å —É—é—Ç–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É, –≤–∫—É—Å–Ω—É—é –∫—É—Ö–Ω—é –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏. –í–Ω—É—Ç—Ä–∏ –∑–∞–≤–µ–¥–µ–Ω–∏—è –µ—Å—Ç—å –±–∞—Ä–Ω–∞—è —Å—Ç–æ–π–∫–∞ —Å–æ —Å—Ç—É–ª—å—è–º–∏, –∞ —Ç–∞–∫–∂–µ —Å—Ç–æ–ª—ã. –ú—É–∑—ã–∫–∞ –≤ FIJI ‚Äî —ç—Ç–æ —Å–º–µ—Å—å —Ç—Ä–µ–∫–æ–≤ —Å —Ä–∞–¥–∏–æ –ï–≤—Ä–æ–ø–∞+ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—Ç –¥–∏–¥–∂–µ—è. –¢–∞–∫–∂–µ –µ—Å—Ç—å –∫–∞—Ä–∞–æ–∫–µ. –¶–µ–Ω—ã –≤ –∑–∞–≤–µ–¥–µ–Ω–∏–∏ ‚Äî —É–º–µ—Ä–µ–Ω–Ω—ã–µ. –ü—Ä–æ–≤–æ–¥—è—Ç—Å—è —Ä–∞–∑–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ –∞–∫—Ü–∏–∏.",
             "https://go.2gis.com/uLqov", 0, "all", 1),
            (11, "Nisha", "–Ω–æ—á–Ω–æ–π –∫–ª—É–±",
             "–≠—Ç–æ –Ω–æ—á–Ω–æ–π –∫–ª—É–± —Å –¥–≤—É–º—è —Ç–∞–Ω—Ü–ø–æ–ª–∞–º–∏. –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø–æ—Å–ª—É—à–∞—Ç—å –∫–∞–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—É—é, —Ç–∞–∫ –∏ –ø–æ–ø-–º—É–∑—ã–∫—É. –ì–æ—Å—Ç–∏ –æ—Ç–º–µ—á–∞—é—Ç –ø—Ä–∏—è—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—å–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞—ë—Ç –∫–æ–º—Ñ–æ—Ä—Ç–Ω—É—é –æ–±—Å—Ç–∞–Ω–æ–≤–∫—É. –ü–µ—Ä—Å–æ–Ω–∞–ª –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –≤—ã–±–æ—Ä–æ–º –Ω–∞–ø–∏—Ç–∫–æ–≤ –∏–ª–∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π. –¢–∞–∫–∂–µ –∑–¥–µ—Å—å –µ—Å—Ç—å –¥–≤–∞ –∑–∞–ª–∞ –¥–ª—è —Ç–∞–Ω—Ü–µ–≤: –±–æ–ª—å—à–∏–π –¥–ª—è —ç–Ω–µ—Ä–≥–∏—á–Ω—ã—Ö –≤–µ—á–µ—Ä–∏–Ω–æ–∫ –∏ –º–µ–Ω—å—à–∏–π –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –±–æ–ª–µ–µ —Å–ø–æ–∫–æ–π–Ω–æ–µ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –ø–æ–¥ –º—É–∑—ã–∫—É —Ä–∞–∑–Ω—ã—Ö –∂–∞–Ω—Ä–æ–≤.",
             "https://go.2gis.com/VOGiT", 0, "all", 1),
            (12, "–ú–æ—Ä—Ä–∏—Å–æ–Ω", "–±–∞—Ä",
             "–≠—Ç–æ –∑–∞–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –∂–∏–≤–æ–π –º—É–∑—ã–∫–æ–π –∏ —Ç–∞–Ω—Ü–∞–º–∏. –ì–æ—Å—Ç–∏ –æ—Ç–º–µ—á–∞—é—Ç, —á—Ç–æ –∑–¥–µ—Å—å –∏–≥—Ä–∞–µ—Ç —Ä–æ–∫-–º—É–∑—ã–∫–∞, –∞ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ –±–∞—Ä –≤—Å–µ–≥–¥–∞ –ø–æ–ª–æ–Ω –ª—é–¥–µ–π. –ò–Ω—Ç–µ—Ä—å–µ—Ä –æ—Ñ–æ—Ä–º–ª–µ–Ω –≤ —Å—Ç–∏–ª–µ —Ä–æ–∫–∞. –ü–æ—Å–µ—Ç–∏—Ç–µ–ª–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –≤—ã–¥–µ–ª—è—é—Ç –±–æ–ª—å—à–æ–π –≤—ã–±–æ—Ä –ø–∏–≤–∞ –∏ –≤–∫—É—Å–Ω—ã–µ –∑–∞–∫—É—Å–∫–∏ –∫ –Ω–µ–º—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á–∏–ø—Å—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –∏ —Ñ–∏—Ä–º–µ–Ω–Ω—ã–µ –±—Ä—É—Å–∫–µ—Ç—Ç—ã. –í –º–µ–Ω—é –µ—Å—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –ø–∏–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Å–æ—Ä—Ç–æ–≤ –Ω–∞ –ª—é–±–æ–π –≤–∫—É—Å, –∞ —Ç–∞–∫–∂–µ –∞–≤—Ç–æ—Ä—Å–∫–∏–µ –∫–æ–∫—Ç–µ–π–ª–∏ –ø–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º —Ü–µ–Ω–∞–º.",
             "https://go.2gis.com/LhfVO", 0, "all", 1),
            (13, "–£ –í–∞—Å –≥–æ—Ä–∏–∑–æ–Ω—Ç –∑–∞–≤–∞–ª–µ–Ω", "–±–∞—Ä",
             "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∫–æ–∫—Ç–µ–π–ª–∏ –∏ —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞! –≠—Ç–æ –∫–æ–∫—Ç–µ–π–ª—å–Ω—ã–π –±–∞—Ä, –≥–¥–µ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–æ–∫—Ç–µ–π–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞. –ì–æ—Å—Ç–∏ –æ—Ç–º–µ—á–∞—é—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–¥–æ–±—Ä–∞—Ç—å –Ω–∞–ø–∏—Ç–∫–∏ –ø–æ –≤–∫—É—Å—É. –ò–Ω—Ç–µ—Ä—å–µ—Ä –∑–∞–≤–µ–¥–µ–Ω–∏—è —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç –∫ –æ—Ç–¥—ã—Ö—É, –∞ —á–∏—Å—Ç–æ—Ç–∞ –≤ —Ç—É–∞–ª–µ—Ç–∞—Ö –≤—Å–µ–≥–¥–∞ –Ω–∞ –≤—ã—Å–æ—Ç–µ. –í –º–µ–Ω—é –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∞–≤—Ç–æ—Ä—Å–∫–∏–µ –∫–æ–∫—Ç–µ–π–ª–∏ —Å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º–∏ —Å–æ—á–µ—Ç–∞–Ω–∏—è–º–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –∏ –∑–∞–∫—É—Å–∫–∏ –¥–ª—è –ø—Ä–∏—è—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è –∑–∞ —Å—Ç–æ–ª–æ–º.",
             "https://go.2gis.com/No1Ax", 0, "all", 1),
            (14, "–û–Ω–µ–≥–∏–Ω", "—Ä—é–º–æ—á–Ω–∞—è",
             "–ö–æ—Ñ–µ–π–Ω—è ¬´–û–Ω–µ–≥–∏–Ω¬ª ‚Äî —ç—Ç–æ —É—é—Ç–Ω–æ–µ –º–µ—Å—Ç–æ, –≥–¥–µ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤—Ä–µ–º—è –≤ –ø—Ä–∏—è—Ç–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏, –Ω–∞—Å–ª–∞–∂–¥–∞—è—Å—å –∞—Ä–æ–º–∞—Ç–Ω—ã–º –∫–æ—Ñ–µ, –∫—Ä—É–∞—Å—Å–∞–Ω–∞–º–∏ –∏ –∫–æ–∫—Ç–µ–π–ª—è–º–∏.",
             "https://go.2gis.com/M72kq", 0, "all", 1),
            (16, "–û—Å—Ç—Ä–æ–≤ –ö–∞–Ω—Ç–∞", "–¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
             "–û–ø–∏—Å–∞–Ω–∏–µ —Å–∞–º–æ–≥–æ –æ—Å—Ç—Ä–æ–≤–∞: –û—Å—Ç—Ä–æ–≤ –ò–º–º–∞–Ω—É–∏–ª–∞ –ö–∞–Ω—Ç–∞ ‚Äî –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ –≤ —Ü–µ–Ω—Ç—Ä–µ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–µ –Ω–∞ —Ä–µ–∫–µ –ü—Ä–µ–≥–æ–ª—è. –†–∞–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞–∫ –ö–Ω–∞–π–ø—Ö–æ—Ñ, –æ–Ω –±—ã–ª —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–º –≥–æ—Ä–æ–¥–æ–º –¥–æ 1724 –≥–æ–¥–∞. –°–µ–≥–æ–¥–Ω—è –æ—Å—Ç—Ä–æ–≤ ‚Äî –∑–µ–ª—ë–Ω–∞—è –∑–æ–Ω–∞ —Å –≥–ª–∞–≤–Ω–æ–π –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é ‚Äî –ö–∞—Ñ–µ–¥—Ä–∞–ª—å–Ω—ã–º —Å–æ–±–æ—Ä–æ–º XIV –≤–µ–∫–∞, –≥–¥–µ –ø–æ–∫–æ–∏—Ç—Å—è —Ñ–∏–ª–æ—Å–æ—Ñ –ò–º–º–∞–Ω—É–∏–ª –ö–∞–Ω—Ç. –°–µ–π—á–∞—Å —ç—Ç–æ –∫—É–ª—å—Ç—É—Ä–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å –∫–æ–Ω—Ü–µ—Ä—Ç–∞–º–∏ –æ—Ä–≥–∞–Ω–Ω–æ–π –º—É–∑—ã–∫–∏, –≤—ã—Å—Ç–∞–≤–∫–∞–º–∏ –∏ —Ñ–µ—Å—Ç–∏–≤–∞–ª—è–º–∏. –í 2016 –≥–æ–¥—É –æ—Å—Ç—Ä–æ–≤—É –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø—Ä–∏—Å–≤–æ–∏–ª–∏ –∏–º—è –ö–∞–Ω—Ç–∞ –≤ —á–µ—Å—Ç—å –µ–≥–æ –≤–∫–ª–∞–¥–∞ –≤ –º–∏—Ä–æ–≤—É—é —Ñ–∏–ª–æ—Å–æ—Ñ–∏—é.",
             "https://go.2gis.com/3BoXt", 0, "all", 0),
            (17, "–§—Ä–µ–Ω—Å–∏—Å –î—Ä–µ–π–∫", "–ø–∞–±",
             "–≠—Ç–æ –ø–∞–±, –≥–¥–µ –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Å–æ—Ä—Ç–∞ –ø–∏–≤–∞, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Ä–µ–¥–∫–∏–µ. –ì–æ—Å—Ç–∏ –æ—Å–æ–±–µ–Ω–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç —Å—Ç—Ä–æ–≥–∞–Ω–∏–Ω—É –∏–∑ –ø–µ–ª–∞–º–∏–¥—ã –∏ –∂–∞—Ä–µ–Ω—ã–π —Å—ã—Ä —Å –±—Ä—É—Å–Ω–∏—á–Ω—ã–º —Å–æ—É—Å–æ–º. –ò–Ω—Ç–µ—Ä—å–µ—Ä –∑–∞–≤–µ–¥–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —Å—Ç–∏–ª–µ. –ó–¥–µ—Å—å –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–≤–µ—Ç–ª–∏–≤—ã–π –ø–µ—Ä—Å–æ–Ω–∞–ª, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑. –≠—Ç–æ –æ—Ç–ª–∏—á–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç—Ä–µ—á –Ω–µ–±–æ–ª—å—à–∏–º–∏ –∫–æ–º–ø–∞–Ω–∏—è–º–∏ –∏–ª–∏ –ø–æ—Å–∏–¥–µ–ª–æ–∫ –∑–∞ –±–∞—Ä–Ω–æ–π —Å—Ç–æ–π–∫–æ–π. –ú–æ—Ä—Å–∫–∞—è —Ç–µ–º–∞—Ç–∏–∫–∞",
             "https://go.2gis.com/j5Cfa", 0, "all", 1),
            (18, "–ï—Å–µ–Ω–∏–Ω", "–±–∞—Ä",
             "–≠—Ç–æ –∑–∞–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ —Å—Ç–∏–ª—å–Ω—ã–º –∏–Ω—Ç–µ—Ä—å–µ—Ä–æ–º –≤ —Ä—É—Å—Å–∫–æ–º —Å—Ç–∏–ª–µ –∏ –±–æ–ª—å—à–∏–º –≤—ã–±–æ—Ä–æ–º –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –∫–æ–∫—Ç–µ–π–ª–µ–π. –ì–æ—Å—Ç–∏ –æ—Ç–º–µ—á–∞—é—Ç –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞–ø–∏—Ç–∫–æ–≤, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞—Å—Ç–æ–π–∫–∏ ¬´–ë–µ–ª–∞—è –Ω–æ—á—å¬ª. –¢–∞–∫–∂–µ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è–º –Ω—Ä–∞–≤—è—Ç—Å—è –∑–∞–∫—É—Å–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ —Ç–∞—Ä—Ç–∞–ª–µ—Ç–∫–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞—á–∏–Ω–∫–∞–º–∏ –∏ –æ–ª–∞–¥—å–∏ —Å –∫—Ä–∞—Å–Ω–æ–π –∏–∫—Ä–æ–π —â—É–∫–∏. –≠—Ç–æ –æ—Ç–ª–∏—á–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –ø—Ä–∏—è—Ç–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞ –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –¥—Ä—É–∑–µ–π –∏–ª–∏ –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è. –°—Ç–∏–ª–∏–∑–æ–≤–∞–Ω –ø–æ–¥ —Å–µ—Ä–µ–±—Ä—è–Ω—ã–π –≤–µ–∫",
             "https://go.2gis.com/v0jaK", 0, "all", 1),
            (19, "–ö–∞—Ñ–µ–¥—Ä–∞–ª—å–Ω—ã–π —Å–æ–±–æ—Ä", "–¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
             "–í 2008 –≥–æ–¥—É –∑–¥–∞–Ω–∏–µ —Å–æ–±–æ—Ä–∞ –±—ã–ª–æ –ø—Ä–µ—Ç–µ–Ω–¥–µ–Ω—Ç–æ–º –Ω–∞ –∑–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏–∑ —á—É–¥–µ—Å –†–æ—Å—Å–∏–∏. –≠—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ —Ä–µ–¥–∫–æ–µ –¥–ª—è –Ω–∞—à–µ–π —Å—Ç—Ä–∞–Ω—ã –≥–æ—Ç–∏—á–µ—Å–∫–æ–µ –∑–¥–∞–Ω–∏–µ –∏ –Ω–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∏–∑ –¥—Ä–µ–≤–Ω–µ–π—à–∏—Ö —Å–æ–±–æ—Ä–æ–≤ –ï–≤—Ä–æ–ø—ã, –Ω–æ –∏ –º–µ—Å—Ç–æ –∑–∞—Ö–æ—Ä–æ–Ω–µ–Ω–∏—è –ò–º–º–∞–Ω—É–∏–ª–∞ –ö–∞–Ω—Ç–∞, –∫–æ—Ç–æ—Ä–æ–≥–æ –º–Ω–æ–≥–∏–µ —Å—á–∏—Ç–∞—é—Ç –≤–µ–ª–∏—á–∞–π—à–∏–º —Ñ–∏–ª–æ—Å–æ—Ñ–æ–º –≤ –∏—Å—Ç–æ—Ä–∏–∏ —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞. –¢–æ—á–Ω–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ —Å–æ–±–æ—Ä–∞ –Ω–∞ –Ω–æ–≤–æ–º –º–µ—Å—Ç–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞. –ù–æ –µ–≥–æ –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è —Å—á–∏—Ç–∞—é—Ç 13 —Å–µ–Ω—Ç—è–±—Ä—è 1333 –≥–æ–¥–∞. –°–ø–µ—Ä–≤–∞ —Ö—Ä–∞–º –¥–æ–ª–∂–µ–Ω –±—ã–ª —Å–ª—É–∂–∏—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏ –∫—Ä–µ–ø–æ—Å—Ç—å—é, –Ω–æ –≥—Ä–æ—Å—Å–º–µ–π—Å—Ç–µ—Ä –¢–µ–≤—Ç–æ–Ω—Å–∫–æ–≥–æ –æ—Ä–¥–µ–Ω–∞ –õ—é—Ç–µ—Ä –ë—Ä–∞—É–Ω—à–≤–µ–π–≥—Å–∫–∏–π –Ω–∞—Å—Ç–æ—è–ª –Ω–∞ —á–∏—Å—Ç–æ –∫—É–ª—å—Ç–æ–≤–æ–º —Å—Ç–∞—Ç—É—Å–µ —Å–æ–±–æ—Ä–∞. –î–æ–ª–≥–æ–µ –≤—Ä–µ–º—è —Å–æ–±–æ—Ä –±—ã–ª –º–µ—Å—Ç–æ–º –∑–∞—Ö–æ—Ä–æ–Ω–µ–Ω–∏—è –≤—ã–¥–∞—é—â–∏—Ö—Å—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π –≤—ã—Å—à–µ–π —Å–≤–µ—Ç—Å–∫–æ–π –∏ –¥—É—Ö–æ–≤–Ω–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏, —Ä–æ–¥–æ–≤–∏—Ç–æ–≥–æ –¥–≤–æ—Ä—è–Ω—Å—Ç–≤–∞. 28 —Ñ–µ–≤—Ä–∞–ª—è 1804 –≥–æ–¥–∞ –∑–¥–µ—Å—å –±—ã–ª –ø–æ—Ö–æ—Ä–æ–Ω–µ–Ω –ò–º–º–∞–Ω—É–∏–ª –ö–∞–Ω—Ç. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–æ–±–æ—Ä –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–ª—Å—è –∫–∞–∫ –æ–±–æ—Ä–æ–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–æ—Ä—É–∂–µ–Ω–∏–µ. –í 1807 –≥–æ–¥—É —á–∞—Å—Ç—å —Å–æ–±–æ—Ä–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –∫–∞–∫ –≤–æ–µ–Ω–Ω–∞—è —Ç—é—Ä—å–º–∞. –ü–æ—Å–ª–µ –≤–æ–π–Ω—ã —Å–æ–±–æ—Ä –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª—Å—è –≤ —Ä—É–∏–Ω—ã –∏ –ø—Ä–µ–±—ã–≤–∞–ª –≤ —Ç–∞–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –¥–æ 1994 –≥–æ–¥–∞. –í 90-–µ —Ö—Ä–∞–º —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–ª–∏. –°–µ–≥–æ–¥–Ω—è —ç—Ç–æ –≤–µ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ—Ä—É–∂–µ–Ω–∏–µ –≤ –≥–æ—Ç–∏—á–µ—Å–∫–æ–º —Å—Ç–∏–ª–µ —Å –≤—ã—Å–æ–∫–æ–π –±–∞—à–Ω–µ–π —Å —á–∞—Å–∞–º–∏. –í –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º –∑–¥–∞–Ω–∏–∏ —Å–æ–±–æ—Ä–∞ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –ø—Ä–æ—Ç–µ—Å—Ç–∞–Ω—Ç—Å–∫–∞—è, –∫–∞—Ç–æ–ª–∏—á–µ—Å–∫–∞—è –∏ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–∞—è —á–∞—Å–æ–≤–Ω–∏, –∞ —Ç–∞–∫–∂–µ –º—É–∑–µ–π —Å–æ–±–æ—Ä–∞ –∏ –º—É–∑–µ–π –ò–º–º–∞–Ω—É–∏–ª–∞ –ö–∞–Ω—Ç–∞. –í —Å–æ–±–æ—Ä–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–ª—è –Ω–∞—à–µ–π —Å—Ç—Ä–∞–Ω—ã –æ—Ä–≥–∞–Ω–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å –∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –¥–≤–∞ —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å, –≤ 14-00 –∏ –≤ 18-00 —Ç–∞–º –ø—Ä–æ—Ö–æ–¥—è—Ç –æ—Ä–≥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ—Ä—Ç—ã. –î–æ–∫—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—è 13 —Å–µ–Ω—Ç—è–±—Ä—è 1333 –≥.",
             "https://go.2gis.com/gBeFL", 0, "all", 1),
            (20, "–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–µ –≤–æ—Ä–æ—Ç–∞", "–¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
             "¬´–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–µ –≤–æ—Ä–æ—Ç–∞ ‚Äî –ø–∞–º—è—Ç–Ω–∏–∫ —Ñ–æ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–∞ XIX –≤–µ–∫–∞. –í –∏—Ö –∑–∞–∫–ª–∞–¥–∫–µ 30 –∞–≤–≥—É—Å—Ç–∞ 1843 –≥–æ–¥–∞ –ø—Ä–∏–Ω–∏–º–∞–ª —É—á–∞—Å—Ç–∏–µ –∫–æ—Ä–æ–ª—å –ü—Ä—É—Å—Å–∏–∏ –§—Ä–∏–¥—Ä–∏—Ö –í–∏–ª—å–≥–µ–ª—å–º IV. –ß–µ—Ä–µ–∑ —ç—Ç–∏ –≤–æ—Ä–æ—Ç–∞ –≤ –ö—ë–Ω–∏–≥—Å–±–µ—Ä–≥ –≤—ä–µ–∑–∂–∞–ª–∏ –ø—Ä–∞–≤–∏—Ç–µ–ª–∏, –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Ä–µ–º–µ—Å–ª–µ–Ω–Ω–∏–∫–∏ –∏ –∫—Ä–µ—Å—Ç—å—è–Ω–µ. –ü–æ—Å–ª–µ –í—Ç–æ—Ä–æ–π –º–∏—Ä–æ–≤–æ–π –≤–æ–π–Ω—ã –≤–æ—Ä–æ—Ç–∞ –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –≤ –∫—Ä–∞–π–Ω–µ —Ç—è–∂—ë–ª–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏: —Å–∫—É–ª—å–ø—Ç—É—Ä—ã –±—ã–ª–∏ —Ä–∞–∑—Ä—É—à–µ–Ω—ã, –æ–±–≤–µ—Ç—à–∞–ª–∞ –∫–∏—Ä–ø–∏—á–Ω–∞—è –∫–ª–∞–¥–∫–∞ —Ñ–∞—Å–∞–¥–æ–≤ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø–æ–º–µ—Ç–∏–π, –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏. –í –ø–ª–∞—á–µ–≤–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –Ω–∞—Ö–æ–¥–∏–ª–∞—Å—å –∏ –æ–∫—Ä—É–∂–∞—é—â–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è. –í —Ñ–µ–≤—Ä–∞–ª–µ 2005 –≥–æ–¥–∞ –≤–æ—Ä–æ—Ç–∞ –±—ã–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã –ú—É–∑–µ—é –ú–∏—Ä–æ–≤–æ–≥–æ –æ–∫–µ–∞–Ω–∞. –ù–∞—á–∞–ª–∞—Å—å —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏—è. –õ–µ—Ç–æ–º 2005 –≥–æ–¥–∞ –∫ 750-–ª–µ—Ç–Ω–µ–º—É —é–±–∏–ª–µ—é –≥–æ—Ä–æ–¥–∞ —Å–æ—Å—Ç–æ—è–ª–æ—Å—å —Ç–æ—Ä–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –≤–æ—Ä–æ—Ç. –°–µ–≥–æ–¥–Ω—è –∑–¥–µ—Å—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏—Å—Ç–æ—Ä–∏–∫–æ-–∫—É–ª—å—Ç—É—Ä–Ω—ã–π —Ü–µ–Ω—Ç—Ä –í–µ–ª–∏–∫–æ–µ –ø–æ—Å–æ–ª—å—Å—Ç–≤–æ –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã –≤ 1850 –≥.",
             "https://go.2gis.com/83zIN", 0, "all", 1),
            (21, "–§–∏–ª–∞—Ä–º–æ–Ω–∏—è", "–¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
             "–ó–¥–∞–Ω–∏–µ –±—ã–ª–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ –≤ 1907 –≥–æ–¥—É –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–º –ø—Ä—É—Å—Å–∫–∏–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–æ–º –§—Ä–∏–¥—Ä–∏—Ö–æ–º –•–∞–π—Ç–º–∞–Ω–Ω–æ–º –∫–∞–∫ –∫–∞—Ç–æ–ª–∏—á–µ—Å–∫–∞—è –∫–∏—Ä—Ö–∞. –í–æ –≤—Ä–µ–º—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –•–∞–π—Ç–º–∞–Ω–Ω –≤–æ –º–Ω–æ–≥–æ–º –≤–¥–æ—Ö–Ω–æ–≤–ª—è–ª—Å—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –≤—Ä–µ–º—ë–Ω –¢–µ–≤—Ç–æ–Ω—Å–∫–æ–≥–æ –æ—Ä–¥–µ–Ω–∞. –ò–º–µ–Ω–Ω–æ –æ—Ç—Ç—É–¥–∞ –≤–∑—è—Ç–∞ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–¥–∞–Ω–∏—è. –ö–∏—Ä—Ö–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –∏–∑ –∫—Ä–∞—Å–Ω–æ–≥–æ –∫–∏—Ä–ø–∏—á–∞. –°–∞–º–∞—è –∑–∞–º–µ—Ç–Ω–∞—è —á–∞—Å—Ç—å –∑–¥–∞–Ω–∏—è ‚Äî –≤—ã—Å–æ–∫–∞—è –±–∞—à–Ω—è —Å —á–∞—Å–∞–º–∏ –∏ –∫—Ä—ã—Ç–æ–π –º–µ–¥—å—é –∫—Ä—ã—à–µ–π. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —á—Ç–æ –≤ –∫–∏—Ä—Ö–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ –ø–∞–Ω–∏—Ö–∏–¥—ã. –¢–æ–ª—å–∫–æ –æ–±—Ä—è–¥—ã –∫—Ä–µ—â–µ–Ω–∏—è –∏ –≤–µ–Ω—á–∞–Ω–∏—è. –ò–Ω–æ–≥–¥–∞ –∫–∏—Ä—Ö—É –Ω–∞–∑—ã–≤–∞–ª–∏ –ö–∞—Ç–µ—Ä–∏–Ω–µ–Ω –ö–∏—Ä—Ö–µ ‚Äî –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ä–∞—Å–ø–æ–ª–∞–≥–∞–≤—à–µ–≥–æ—Å—è —Ä—è–¥–æ–º –≥–æ—Å–ø–∏—Ç–∞–ª—è –°–≤—è—Ç–æ–π –ö–∞—Ç–µ—Ä–∏–Ω—ã. –í 1945 –≥–æ–¥—É —Ü–µ—Ä–∫–æ–≤—å –±—ã–ª–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞ –∏ –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –æ—Å—Ç–∞–≤–∞–ª–∞—Å—å –∑–∞–±—Ä–æ—à–µ–Ω–Ω–æ–π, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Ä–∞–∑—Ä—É—à–∞–ª–∞—Å—å. –í 1980 –≥–æ–¥—É –ø–æ—Å–ª–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ–¥ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ –ü–∞–≤–ª–∞ –ì–æ—Ä–±–∞—á–∞ –≤ –Ω–µ–π –±—ã–ª–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç–Ω–∞—è —Ñ–∏–ª–∞—Ä–º–æ–Ω–∏—è. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∞ –≤ 1907 –≥.",
             "https://go.2gis.com/DgnhF", 0, "all", 1),
            (22, "–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∏–π –∑–æ–æ–ø–∞—Ä–∫", "–¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
             "–≠—Ç–æ –æ–¥–∏–Ω –∏–∑ —Å—Ç–∞—Ä–µ–π—à–∏—Ö –∑–æ–æ–ø–∞—Ä–∫–æ–≤ –†–æ—Å—Å–∏–∏, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞. –ü–æ—Å–µ—Ç–∏—Ç–µ–ª–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –æ—Ç–º–µ—á–∞—é—Ç –µ–≥–æ –±–æ–ª—å—à—É—é —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é —Å –æ–±–∏–ª–∏–µ–º –∑–µ–ª–µ–Ω–∏ –∏ –¥–µ—Ä–µ–≤—å–µ–≤, –∞ —Ç–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–≤–∏–¥–µ—Ç—å –∑–¥–µ—Å—å –∂–∏—Ä–∞—Ñ–æ–≤, —Å–ª–æ–Ω–æ–≤ –∏ –±–µ–≥–µ–º–æ—Ç–æ–≤. –ó–∏–º–æ–π –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö –ø–µ—Ä–µ–º–µ—â–∞—é—Ç –≤ –∫—Ä—ã—Ç—ã–µ –∑–∏–º–Ω–∏–∫–∏ –¥–ª—è –∏—Ö –∑–∞—â–∏—Ç—ã –æ—Ç —Ö–æ–ª–æ–¥–∞. –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∏–π –∑–æ–æ–ø–∞—Ä–∫ ‚Äî –æ–¥–∏–Ω –∏–∑ —Å—Ç–∞—Ä–µ–π—à–∏—Ö –∑–æ–æ–ø–∞—Ä–∫–æ–≤ –†–æ—Å—Å–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –≤ 1896 –≥–æ–¥—É –≤ –ö—ë–Ω–∏–≥—Å–±–µ—Ä–≥–µ –ø–æ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–µ –ø—Ä–æ—Ñ–µ—Å—Å–æ—Ä–∞ –ú–∞–∫—Å–∏–º–∏–ª–∏–∞–Ω–∞ –ë—Ä–∞—É–Ω–∞ –∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—è –ì–µ—Ä–º–∞–Ω–∞ –ö–ª–∞–∞—Å—Å–∞. –°–µ–≥–æ–¥–Ω—è –∑–æ–æ–ø–∞—Ä–∫ –∑–∞–Ω–∏–º–∞–µ—Ç —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é –±–æ–ª–µ–µ 16 –≥–µ–∫—Ç–∞—Ä–æ–≤ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–≤—ã—à–µ 260 –≤–∏–¥–æ–≤ –∂–∏–≤–æ—Ç–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è —Ä–µ–¥–∫–∏–µ –∏ –∏—Å—á–µ–∑–∞—é—â–∏–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ –±–µ–ª—ã–π –Ω–æ—Å–æ—Ä–æ–≥ –∏ –∞–º—É—Ä—Å–∫–∏–π —Ç–∏–≥—Ä.–ó–æ–æ–ø–∞—Ä–∫ —Ç–∞–∫–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–µ–Ω–¥—Ä–æ–ø–∞—Ä–∫–∞: –Ω–∞ –µ–≥–æ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–∏–∑—Ä–∞—Å—Ç–∞—é—Ç —Ä–µ–¥–∫–∏–µ –≤–∏–¥—ã —Ä–∞—Å—Ç–µ–Ω–∏–π, –≤–∫–ª—é—á–∞—è –≥–∏–Ω–∫–≥–æ. –í –≥–æ–¥—ã –í—Ç–æ—Ä–æ–π –º–∏—Ä–æ–≤–æ–π –≤–æ–π–Ω—ã –∑–æ–æ–ø–∞—Ä–∫ –±—ã–ª —Å–∏–ª—å–Ω–æ —Ä–∞–∑—Ä—É—à–µ–Ω, –Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Å 1947 –≥–æ–¥–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–∞–∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ. –û–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é –ø–ª–∞–Ω–∏—Ä–æ–≤–∫—É –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã, —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –ø–æ –æ—Ö—Ä–∞–Ω–µ –∂–∏–≤–æ—Ç–Ω—ã—Ö –∏ –ø—Ä–æ—à—ë–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –Ω–∞ —É–ª—É—á—à–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∂–∏–≤–æ—Ç–Ω—ã—Ö –∏ –∫–æ–º—Ñ–æ—Ä—Ç–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π.",
             "https://go.2gis.com/M2LKW", 0, "all", 0),
            (23, "–ó–µ–ª–µ–Ω–æ–≥—Ä–∞–¥—Å–∫", "–≥–æ—Ä–æ–¥",
             "—É—é—Ç–Ω—ã–π –∫—É—Ä–æ—Ä—Ç–Ω—ã–π –≥–æ—Ä–æ–¥ –Ω–∞ –±–µ—Ä–µ–≥—É –ë–∞–ª—Ç–∏–π—Å–∫–æ–≥–æ –º–æ—Ä—è, –∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–≤–æ–∏–º–∏ —à–∏—Ä–æ–∫–∏–º–∏ –ø–µ—Å—á–∞–Ω—ã–º–∏ –ø–ª—è–∂–∞–º–∏, –¥—é–Ω–∞–º–∏ –∏ —Å–ø–æ–∫–æ–π–Ω–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä–æ–π. –≠—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –Ω–µ—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞ –∏ –ø—Ä–æ–≥—É–ª–æ–∫.",
             "https://go.2gis.com/ki3TD", 1, "spring,summer", 0)
        ]

        events_data = [
            ("–°–∏—Ç–∏–¥–∂–∞–∑ —Ñ–µ—Å—Ç", "XVIII –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π —Ñ–µ—Å—Ç–∏–≤–∞–ª—å ¬´–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥ –°–∏—Ç–∏ –î–∂–∞–∑¬ª", "2025-08-01",
             "2025-08-03", "https://vk.com/jazzfestivalru"),
            ("–ù–æ—á—å –º—É–∑–µ–µ–≤", "–ï–∂–µ–≥–æ–¥–Ω–∞—è –∫—É–ª—å—Ç—É—Ä–Ω–∞—è –∞–∫—Ü–∏—è", "2024-05-18", "2024-05-18", "https://museum.ru"),
            ("–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∏–π –º–∞—Ä–∞—Ñ–æ–Ω", "–ì–æ—Ä–æ–¥—Å–∫–æ–π –º–∞—Ä–∞—Ñ–æ–Ω", "2024-09-15", "2024-09-15",
             "https://kaliningrad-marathon.ru")
        ]

        with sqlite3.connect(self.db_path) as conn:
            cursor = conn.cursor()

            cursor.execute("DELETE FROM places")
            cursor.execute("DELETE FROM events")

            cursor.executemany('''
                INSERT OR REPLACE INTO places (id, name, type, description, link, is_seasonal, best_season, indoor)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?)
            ''', places_data)

            cursor.executemany('''
                INSERT INTO events (name, description, start_date, end_date, link)
                VALUES (?, ?, ?, ?, ?)
            ''', events_data)

            conn.commit()



class VisitAgent:

    def __init__(self, db_path: str = "places.db", language:str = 'ru', is_random: bool = False):
        self.db_path = db_path
        self.db = PlacesDatabase(db_path)
        self.client = self.initialize_client()
        self.language = language
        self.is_random = is_random
        self.db.populate_database()

        self.convert_language()

    @staticmethod
    def initialize_client():
        return GigaChat(
            credentials=settings.GIGA_CREDENTIALS,
            model="GigaChat-2-Max",
            profanity_check=False,
            temperature=0.4,
            timeout=120,
            verify_ssl_certs=False
        )

    def convert_language(self):
        language_names = {
            'ru': 'Russian',
            'en': 'English',
            'fr': 'French',
            'es': 'Spanish',
            'cn': 'Chinese Traditional',
            'in': 'Hindi'
        }
        self.language = language_names.get(self.language, 'Russian')

    async def get_recommendations(self, user_query: str) -> str:
        """Get recommendations based on user request"""
        try:
            places = self._get_all_places()

            current_events = self._get_current_events()

            prompt = self._build_prompt(user_query, places, current_events)

            response = await self._get_llm_response(prompt)

            return response

        except Exception as e:
            return f"‚ùå **–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞**\n\n–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–æ–±—Ä–∞—Ç—å –º–µ—Å—Ç–∞: {str(e)}"

    def _get_all_places(self) -> List[Dict[str, Any]]:
        """Get all places from DB"""
        with sqlite3.connect(self.db_path) as conn:
            cursor = conn.cursor()
            cursor.execute('''
                SELECT name, type, description, link, is_seasonal, best_season, indoor 
                FROM places
            ''')

            places = []
            for row in cursor.fetchall():
                places.append({
                    'name': row[0],
                    'type': row[1],
                    'description': row[2],
                    'link': row[3],
                    'is_seasonal': bool(row[4]),
                    'best_season': row[5],
                    'indoor': bool(row[6])
                })
            return places

    def _get_current_events(self) -> List[Dict[str, Any]]:
        """Get actual events"""
        with sqlite3.connect(self.db_path) as conn:
            cursor = conn.cursor()
            cursor.execute('''
                SELECT name, description, start_date, end_date, link 
                FROM events 
                WHERE is_active = 1 AND end_date >= date('now')
            ''')

            events = []
            for row in cursor.fetchall():
                events.append({
                    'name': row[0],
                    'description': row[1],
                    'start_date': row[2],
                    'end_date': row[3],
                    'link': row[4]
                })
            return events

    def _build_prompt(self, user_query: str, places: List[Dict], events: List[Dict]) -> str:
        """Build prompt for LLM"""
        if self.is_random:
            random_place = random.choice(places)
            prompt_random = f"""
            –¢—ã –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –ø–æ–¥–±–æ—Ä—É –º–µ—Å—Ç –¥–ª—è –ø–æ—Å–µ—â–µ–Ω–∏—è –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–µ.
            –¢–µ–±–µ –±—É–¥–µ—Ç –¥–∞–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ –æ–¥–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –º–µ—Å—Ç–æ, –ø—Ä–µ–æ–±—Ä–∞–∑—É–π –≤ —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞.
            
            –ú–µ—Å—Ç–æ: f"**{random_place['name']}** ({random_place['type']}) - {random_place['description']}\n üîó {random_place['link']}\n\n"
            
            –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –≤ Markdown:
            –Ø–ó–´–ö –î–õ–Ø –¢–í–û–ï–ì–û –û–¢–í–ï–¢–ê: {self.language} - —Ç—ã –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –¢–û–õ–¨–ö–û –Ω–∞ –Ω–µ–º –≤ —Ä–∞–º–∫–∞—Ö –≤—Å–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è, –¥–∞–∂–µ –µ—Å–ª–∏ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ —è–∑—ã–∫–∞ –≤–º–µ—Å—Ç–æ {self.language} –ó–ê–ü–†–ï–©–ï–ù–û!
            
    
            üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≤–∞—Å:
    
            1. **[–ù–∞–∑–≤–∞–Ω–∏–µ]** [—ç–º–æ–¥–∑–∏]
            üìç **–û–ø–∏—Å–∞–Ω–∏–µ:** [–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ]
            üîó **–°—Å—ã–ª–∫–∞:** [—Å—Å—ã–ª–∫–∞]
            üí° **–ü–æ—á–µ–º—É –ø–æ–¥—Ö–æ–¥–∏—Ç:** [–æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ]

            –ë—É–¥—å –∫—Ä–∞—Ç–æ–∫ –∏ —Ç–æ—á–µ–Ω"""
            return prompt_random

        else:
            places_context = "–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Å—Ç–∞:\n"
            for i, place in enumerate(places, 1):
                places_context += f"{i}. **{place['name']}** ({place['type']}) - {place['description']}\n"
                if place['is_seasonal']:
                    places_context += f"   üçÇ –°–µ–∑–æ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ, –ª—É—á—à–µ –ø–æ—Å–µ—â–∞—Ç—å: {place['best_season']}\n"
                if place['indoor']:
                    places_context += f"   üèõÔ∏è –ö—Ä—ã—Ç–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ\n"
                places_context += f"   üîó {place['link']}\n\n"

            events_context = "–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:\n"
            for event in events:
                events_context += f"üé™ **{event['name']}** - {event['description']} ({event['start_date']} - {event['end_date']})\n"
                events_context += f"   üîó {event['link']}\n\n"

            prompt = f"""
            –¢—ã –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –ø–æ–¥–±–æ—Ä—É –º–µ—Å—Ç –¥–ª—è –ø–æ—Å–µ—â–µ–Ω–∏—è –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–µ. 
            –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç: "{user_query}"
    
            {places_context}
            {events_context}
    
            –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–æ–¥–±–µ—Ä–∏ –¢–û–ü-3 –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –º–µ—Å—Ç–∞/—Å–æ–±—ã—Ç–∏—è.
    
            –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ—Ç–≤–µ—Ç—É:
            - –ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–ø–∏—Å–∫–æ–º
            - –ö–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —ç–º–æ–¥–∑–∏
            - –°–æ—Ö—Ä–∞–Ω—è–π —Å–∏–º–≤–æ–ª—ã * –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ
            - –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
            - –£–∫–∞–∑–∞–Ω–∏–µ —Ç–∏–ø–∞ –º–µ—Å—Ç–∞
            - –°—Å—ã–ª–∫—É –Ω–∞ 2gis –∏–ª–∏ —Å–∞–π—Ç
            - –ü–æ—á–µ–º—É —ç—Ç–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    
            –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –≤ Markdown:
    
            üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≤–∞—Å:
             –Ø–ó–´–ö –î–õ–Ø –¢–í–û–ï–ì–û –û–¢–í–ï–¢–ê: {self.language} - —Ç—ã –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –¢–û–õ–¨–ö–û –Ω–∞ –Ω–µ–º –≤ —Ä–∞–º–∫–∞—Ö –≤—Å–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è, –¥–∞–∂–µ –µ—Å–ª–∏ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ —è–∑—ã–∫–∞ –≤–º–µ—Å—Ç–æ {self.language} –ó–ê–ü–†–ï–©–ï–ù–û!
        
    
            1. **[–ù–∞–∑–≤–∞–Ω–∏–µ]** [—ç–º–æ–¥–∑–∏]
            üìç **–û–ø–∏—Å–∞–Ω–∏–µ:** [–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ]
            üîó **–°—Å—ã–ª–∫–∞:** [—Å—Å—ã–ª–∫–∞]
            üí° **–ü–æ—á–µ–º—É –ø–æ–¥—Ö–æ–¥–∏—Ç:** [–æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ]
    
            2. **[–ù–∞–∑–≤–∞–Ω–∏–µ]** [—ç–º–æ–¥–∑–∏]
            ...
    
            3. **[–ù–∞–∑–≤–∞–Ω–∏–µ]** [—ç–º–æ–¥–∑–∏]
            ...
    
            –ï—Å–ª–∏ –µ—Å—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Å–æ–±—ã—Ç–∏—è, –≤–∫–ª—é—á–∏ –∏—Ö –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
            –ë—É–¥—å –∫—Ä–∞—Ç–æ–∫ –∏ —Ç–æ—á–µ–Ω!
            """

            return prompt

    async def _get_llm_response(self, prompt: str) -> str:
        """Get response from LLM"""
        try:
            if self.is_random:
                messages = [HumanMessage(content=prompt)]
                response = await asyncio.get_event_loop().run_in_executor(
                    None,
                    lambda: self.client.invoke(messages))
                return response.content

            else:

                messages = [HumanMessage(content=prompt)]
                response = await asyncio.get_event_loop().run_in_executor(
                    None,
                    lambda: self.client.invoke(messages)
                )
                return response.content
        except Exception as e:
            return f"‚ùå **–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞**\n\n–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."

    async def close(self):
        """Close connection"""
        if hasattr(self.client, 'close'):
            await self.client.close()
